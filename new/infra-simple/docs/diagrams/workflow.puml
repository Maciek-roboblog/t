@startuml workflow
!theme plain
skinparam backgroundColor white
skinparam defaultFontName Helvetica
skinparam shadowing false

skinparam activity {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
}

title Fine-tuning Workflow

start

partition "Setup" {
    :Deploy base resources;
    note right: ./deploy.sh base
}

partition "Training" {
    :Open WebUI or submit Job;
    note right: ./ui.sh webui\nor kubectl apply

    :Configure training params;

    :Run training (GPU);
    note right
      Output: /storage/output/lora-adapter
      Metrics: MLflow
    end note
}

partition "Merge" {
    :Merge LoRA + base model;
    note right: kubectl apply -f merge-job.yaml

    :Output merged model;
    note right: /storage/models/merged-model
}

partition "Inference" {
    :vLLM loads model;
    note right
      External service
      Reads from NFS
    end note
}

stop

@enduml
