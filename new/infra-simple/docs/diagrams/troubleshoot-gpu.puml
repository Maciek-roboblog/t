@startuml troubleshoot-gpu
!theme plain
skinparam backgroundColor #FEFEFE

title Troubleshooting: Brak GPU

start
:Pod nie startuje\n"Insufficient nvidia.com/gpu";

:Sprawdź GPU nodes;
note right
  kubectl get nodes
  -l nvidia.com/gpu
end note

if (Są GPU nodes?) then (nie)
  :Dodaj GPU node pool;
  note right
    gcloud container
    node-pools create...
  end note
else (tak)
  :Sprawdź NVIDIA plugin;
  note right
    kubectl get pods
    -n kube-system
    -l name=nvidia-device-plugin
  end note

  if (Plugin działa?) then (nie)
    :Zainstaluj plugin;
  else (tak)
    :Sprawdź tolerations w podzie;
    note right
      tolerations:
      - key: "nvidia.com/gpu"
        operator: "Exists"
    end note
  endif
endif

stop

@enduml
