# GPU Time-Slicing ConfigMap
# Pozwala na współdzielenie jednego GPU między wieloma podami
#
# UWAGA: Time-slicing NIE zapewnia izolacji pamięci GPU!
# Wszystkie pody współdzielą tę samą pamięć GPU.
#
# Źródło: https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/gpu-sharing.html
#
apiVersion: v1
kind: ConfigMap
metadata:
  name: time-slicing-config
  namespace: gpu-operator
data:
  # Konfiguracja dla wszystkich GPU w klastrze
  # replicas: 2 = 1 fizyczne GPU widoczne jako 2 logiczne
  any: |
    version: v1
    flags:
      migStrategy: none
    sharing:
      timeSlicing:
        renameByDefault: false
        failRequestsGreaterThanOne: false
        resources:
          - name: nvidia.com/gpu
            replicas: 2
---
# Jeśli masz konkretny model GPU, możesz użyć dedykowanej konfiguracji
# Przykład dla RTX 3090 / RTX 4090:
#
# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: time-slicing-config-rtx
#   namespace: gpu-operator
# data:
#   rtx-4090: |
#     version: v1
#     sharing:
#       timeSlicing:
#         resources:
#           - name: nvidia.com/gpu
#             replicas: 4  # 4 logiczne GPU
